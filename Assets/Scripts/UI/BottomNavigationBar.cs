using UnityEngine;
using UnityEngine.EventSystems;
using System.Collections.Generic;

public class BottomNavigationBar : MonoBehaviour
{
    [Header("Drag here the 5 buttons")]
    public RectTransform button1;
    public RectTransform button2;
    public RectTransform button3;
    public RectTransform button4;
    public RectTransform button5;

    [Header("Hover Settings")]
    public float initialScale = 1f;   // ?????? ??????? – ?? ????? ??? Hover
    public float hoverScale = 1.08f;  // ?????? ???? Hover
    public float speed = 10f;         // ?????? ???????? ????? ?????

    private List<RectTransform> buttons = new List<RectTransform>();
    private RectTransform hovered; // ???? ????? ???? ??? Hover

    void Start()
    {
        // ??????? ?? ?? ???????? ??????
        buttons.Add(button1);
        buttons.Add(button2);
        buttons.Add(button3);
        buttons.Add(button4);
        buttons.Add(button5);

        // ??????? ??? ????? ????? ?? ?????? ???????
        foreach (var btn in buttons)
        {
            btn.localScale = Vector3.one * initialScale;
            AddEvents(btn.gameObject); // ??????? ??? ????? ?????? Hover
        }
    }

    void Update()
    {
        // ?????? ?? ?? ???????? ???????? ?? ????? ????? ???? Hover
        foreach (var btn in buttons)
        {
            // ?? ?????? ??? ?? ????? ?-hover ????? ????
            float target = (btn == hovered) ? hoverScale : initialScale;

            // ??????? ???? ????? ??? ??????
            btn.localScale = Vector3.Lerp(
                btn.localScale,
                Vector3.one * target,
                Time.deltaTime * speed
            );
        }
    }

    // ??????? ??????? listener ?? Hover ??? ?????
    private void AddEvents(GameObject obj)
    {
        // ?? ??? EventTrigger ?? ?????? – ????? ???
        EventTrigger trigger = obj.GetComponent<EventTrigger>();
        if (trigger == null)
            trigger = obj.AddComponent<EventTrigger>();

        // Pointer Enter – ??????? ???? ??????
        EventTrigger.Entry enter = new EventTrigger.Entry();
        enter.eventID = EventTriggerType.PointerEnter;
        enter.callback.AddListener((_) =>
        {
            // ?????? ?? ?????? ?????? ???? ????
            hovered = obj.GetComponent<RectTransform>();
        });
        trigger.triggers.Add(enter);

        // Pointer Exit – ??????? ???? ???????
        EventTrigger.Entry exit = new EventTrigger.Entry();
        exit.eventID = EventTriggerType.PointerExit;
        exit.callback.AddListener((_) =>
        {
            // ?? ?? ?????? ???? ?-hover, ??????
            if (hovered == obj.GetComponent<RectTransform>())
                hovered = null;
        });
        trigger.triggers.Add(exit);
    }
}
